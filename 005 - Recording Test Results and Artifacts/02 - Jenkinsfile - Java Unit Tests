pipeline {
    agent { 
		docker { 
			image 'maven:latest' 
		}
	}
    stages {
    	environment {
                POM_PATH = '005 - Recording Test Results and Artifacts/02 - Java Unit Tests/pom.xml'
            }
    	stage('build'){
	   sh "mvn install -f $POM_PATH -Dmaven.test.skip=true"
	}
        stage('tests') {
            steps {
	      configFileProvider(
        	[configFile(fileId: 'settings.xml', variable: 'MAVEN_SETTINGS')]) {
       			 sh "mvn -s $MAVEN_SETTINGS clean package"
    			}
                sh "mvn test"
            }
        }
    }
}
